var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},h5game;!function(t){var e=function(e){function n(n){var r=e.call(this,n)||this;return r.mcst=t.MCST.LOAD,r}return __extends(n,e),n.prototype.gotoAndPlay=function(n,r){void 0===r&&(r=0),this.mcst==t.MCST.LOAD&&e.prototype.gotoAndPlay.call(this,n,r)},n.prototype.gotoAndStop=function(n){this.mcst==t.MCST.LOAD&&e.prototype.gotoAndStop.call(this,n)},n}(egret.MovieClip);t.MCAdv=e,__reflect(e.prototype,"h5game.MCAdv")}(h5game||(h5game={}));var h5game;!function(t){var e=function(){function t(){this._configMap={},this._manifest=null}return t.prototype.init=function(){var t=new JSZip(RES.getRes("movieclip_zip"));this.initManifest(t),this.initMCCnf(t),RES.destroyRes("movieclip_zip")},t.prototype.initManifest=function(t){var e=JSON.parse(t.file("manifest.json").asText());this._manifest=e},t.prototype.initMCCnf=function(t){for(var e in this._manifest){var n=JSON.parse(t.file(e+".json").asText());this.regMCCnf(e,n)}},t.prototype.regMCCnf=function(t,e){return e?this._configMap[t]?(console.log("MCCnfMgr_regMCCnf config already exist",t),!1):(this._configMap[t]=e,!0):!1},t.prototype.getMCCnf=function(t){var e=this._configMap[t];return e||console.log("MCCnfMgr_getMCCnf invalid key",t),e},t.prototype.getHash=function(t){return this._manifest[t]},t}();t.MCCnfMgr=e,__reflect(e.prototype,"h5game.MCCnfMgr")}(h5game||(h5game={}));var h5game;!function(t){var e;!function(t){t[t.UNINIT=1]="UNINIT",t[t.LOAD=2]="LOAD",t[t.UNLOAD=3]="UNLOAD"}(e=t.MCST||(t.MCST={}));var n;!function(t){t[t.UNINIT=1]="UNINIT",t[t.UNLOAD=2]="UNLOAD",t[t.LOADING=3]="LOADING",t[t.LOADED=4]="LOADED"}(n=t.MCPST||(t.MCPST={}))}(h5game||(h5game={}));var h5game;!function(t){var e=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype.setTexture=function(e){if(t.prototype.setTexture.call(this,e),this.enableCache)for(var n in this.$mcDataCache){var r=this.$mcDataCache[n];r.spriteSheet=this.$spriteSheet}},e}(egret.MovieClipDataFactory);t.MCDataFtryAdv=e,__reflect(e.prototype,"h5game.MCDataFtryAdv")}(h5game||(h5game={}));var h5game;!function(t){var e=function(e){function n(r,i){var o=e.call(this,r)||this;return o._state=t.MCPST.UNINIT,o._mcDataFtry=null,o._mcCnfMgr=null,o._mcCnfMgr=i,o._autoRecycleInterval=n.DEF_AUTO_RECYCLE_INTERVAL,o._state=t.MCPST.UNLOAD,o}return __extends(n,e),n.getAssets=function(t,e){var n=egret.getImplementation("eui.IAssetAdapter");n.getAsset(t,function(t){e(t)},this)},n.prototype.getImagePath=function(t){var e=RES.config.resourceRoot+"movieclip/"+t+".png",n=this._mcCnfMgr.getHash(t);return n&&n.length>0&&(e+="?v="+n),e},n.prototype.createObj=function(e){return new t.MCAdv(this._mcDataFtry.generateMovieClipData(e))},n.prototype.reload=function(e){this._mcDataFtry.texture=e;for(var n in this._actPool){var r=this._actPool[n];r.mcst==t.MCST.UNLOAD&&(r.mcst=t.MCST.LOAD)}},n.prototype.create=function(r){if(this._lastActiveTick=egret.getTimer(),this._mcDataFtry||(this._mcDataFtry=new t.MCDataFtryAdv(this._mcCnfMgr.getMCCnf(r))),this._state==t.MCPST.UNLOAD){this._state=t.MCPST.LOADING;var i=this,o=this.getImagePath(r);n.getAssets(o,function(e){i._state=t.MCPST.LOADED,egret.callLater(function(){i.reload(e)},i)})}return e.prototype.create.call(this,r)},n.prototype.release=function(){e.prototype.release.call(this);var t=this.getImagePath(this._name);RES.destroyRes(t),this._mcDataFtry=null,this._mcCnfMgr=null},n.prototype.canRelease=function(){return 0==this._actPool.length&&egret.getTimer()-this._lastActiveTick>n.DEF_RELEASE_TIME},n.DEF_RELEASE_TIME=6e4,n.DEF_AUTO_RECYCLE_INTERVAL=5e3,n}(t.ObjPool);t.MCPool=e,__reflect(e.prototype,"h5game.MCPool")}(h5game||(h5game={}));var h5game;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._init=!1,t._mcCnfMgr=null,t}return __extends(n,e),n.prototype.init=function(){return this._init?void console.warn("MCFtry already init"):(this._init=!0,this._mcCnfMgr=new t.MCCnfMgr,void this._mcCnfMgr.init())},n.prototype.createPool=function(e){return new t.MCPool(e,this._mcCnfMgr)},n}(t.ObjFtry);t.MCFtry=e,__reflect(e.prototype,"h5game.MCFtry")}(h5game||(h5game={}));