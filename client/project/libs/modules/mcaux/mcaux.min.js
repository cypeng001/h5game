var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},h5game;!function(t){var e=function(e){function n(n,i,r){var a=e.call(this,n)||this;return a._pool=null,a._mcDatas={},a.mcst=t.MCST.LOAD,a._key=i,a._pool=r,a}return __extends(n,e),n.prototype.gotoAndPlay=function(n,i){void 0===i&&(i=0),this.mcst==t.MCST.LOAD&&e.prototype.gotoAndPlay.call(this,n,i)},n.prototype.gotoAndStop=function(n){this.mcst==t.MCST.LOAD&&e.prototype.gotoAndStop.call(this,n)},n.prototype.playAnimation=function(e,n){if(void 0===n&&(n=0),this.mcst==t.MCST.LOAD){if(this._pool.getMCDataCnt()>1){var i=this._mcDatas[e];i||(i=this._mcDatas[e]=this._pool.createMovieClipData(this._key+"_"+e)),this.movieClipData=i}this.gotoAndPlay(e,n)}},n}(egret.MovieClip);t.MCAdv=e,__reflect(e.prototype,"h5game.MCAdv")}(h5game||(h5game={}));var h5game;!function(t){var e=function(){function t(){this._configMap={},this._manifest=null}return t.prototype.init=function(){var t=new JSZip(RES.getRes("movieclip_zip"));this.initManifest(t),this.initMCCnf(t),RES.destroyRes("movieclip_zip")},t.prototype.initManifest=function(t){var e=JSON.parse(t.file("manifest.json").asText());this._manifest=e},t.prototype.initMCCnf=function(t){for(var e in this._manifest){var n=this.getFilelist(e);for(var i in n){var r=n[i],a=JSON.parse(t.file(r+".json").asText());this.regMCCnf(r,a)}}},t.prototype.regMCCnf=function(t,e){return e?this._configMap[t]?(console.warn("MCCnfMgr_regMCCnf config already exist",t),!1):(this._configMap[t]=e,!0):(console.warn("MCCnfMgr_regMCCnf config is null",t),!1)},t.prototype.getMCCnf=function(t){var e=this._configMap[t];return e||console.warn("MCCnfMgr_getMCCnf config is null",t),e},t.prototype.getHash=function(t){return this._manifest[t].crc},t.prototype.getFilelist=function(t){return this._manifest[t].files},t}();t.MCCnfMgr=e,__reflect(e.prototype,"h5game.MCCnfMgr")}(h5game||(h5game={}));var h5game;!function(t){var e;!function(t){t[t.UNINIT=1]="UNINIT",t[t.LOAD=2]="LOAD",t[t.UNLOAD=3]="UNLOAD"}(e=t.MCST||(t.MCST={}));var n;!function(t){t[t.UNINIT=1]="UNINIT",t[t.UNLOAD=2]="UNLOAD",t[t.LOADING=3]="LOADING",t[t.LOADED=4]="LOADED"}(n=t.MCPST||(t.MCPST={}))}(h5game||(h5game={}));var h5game;!function(t){var e=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype.setTexture=function(e){if(t.prototype.setTexture.call(this,e),this.enableCache)for(var n in this.$mcDataCache){var i=this.$mcDataCache[n];i.spriteSheet=this.$spriteSheet}},e}(egret.MovieClipDataFactory);t.MCDataFtryAdv=e,__reflect(e.prototype,"h5game.MCDataFtryAdv")}(h5game||(h5game={}));var h5game;!function(t){var e=function(e){function n(i,r){var a=e.call(this,i)||this;return a._state=t.MCPST.UNINIT,a._mcDataFtrys=null,a._mcDataCnt=0,a._mcCnfMgr=null,a._mcCnfMgr=r,a._autoRecycleInterval=n.DEF_AUTO_RECYCLE_INTERVAL,a._state=t.MCPST.UNLOAD,a}return __extends(n,e),n.getAssets=function(t,e){var n=egret.getImplementation("eui.IAssetAdapter");n.getAsset(t,function(t){e(t)},this)},n.prototype.getImagePath=function(t){return RES.config.resourceRoot+"movieclip/"+t+".png"},n.prototype.createObj=function(e,n){var i=null;return 1==this.getMCDataCnt()&&(i=this._mcDataFtrys[e].generateMovieClipData(e)),new t.MCAdv(i,e,this)},n.prototype.reload=function(e,n){if(this._mcDataFtrys[e].texture=n,this._state==t.MCPST.LOADED)for(var i in this._actPool){var r=this._actPool[i];r.mcst==t.MCST.UNLOAD&&(r.mcst=t.MCST.LOAD)}},n.prototype.create=function(i,r){void 0===r&&(r=null),this._lastActiveTick=egret.getTimer();var a=this._mcCnfMgr.getFilelist(i);if(!this._mcDataFtrys){this._mcDataFtrys={};for(var o in a){var s=a[o];this._mcDataFtrys[s]=new t.MCDataFtryAdv(this._mcCnfMgr.getMCCnf(s)),this._mcDataCnt++}}if(this._state==t.MCPST.UNLOAD){this._state=t.MCPST.LOADING;var c=this,h=0;for(var o in a){var _=this.getImagePath(a[o]),f=this._mcCnfMgr.getHash(i);f&&f.length>0&&(_+="?v="+f),n.getAssets(_,function(e){egret.callLater(function(){h++,h==a.length&&(c._state=t.MCPST.LOADED),c.reload(a[h-1],e)},c)})}}return e.prototype.create.call(this,i,r)},n.prototype.release=function(){e.prototype.release.call(this);var t=this._mcCnfMgr.getFilelist(this._name);for(var n in t){var i=t[n],r=this.getImagePath(i);RES.destroyRes(r)}this._mcDataFtrys=null,this._mcCnfMgr=null},n.prototype.canRelease=function(){return 0==this._actPool.length&&egret.getTimer()-this._lastActiveTick>n.DEF_RELEASE_TIME},n.prototype.getMCDataCnt=function(){return this._mcDataCnt},n.prototype.createMovieClipData=function(t){return this._mcDataFtrys[t].generateMovieClipData(t)},n.DEF_RELEASE_TIME=6e4,n.DEF_AUTO_RECYCLE_INTERVAL=5e3,n}(t.ObjPool);t.MCPool=e,__reflect(e.prototype,"h5game.MCPool")}(h5game||(h5game={}));var h5game;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._init=!1,t._mcCnfMgr=null,t}return __extends(n,e),n.prototype.init=function(){return this._init?void console.warn("MCFtry already init"):(this._init=!0,this._mcCnfMgr=new t.MCCnfMgr,void this._mcCnfMgr.init())},n.prototype.createPool=function(e){return new t.MCPool(e,this._mcCnfMgr)},n}(t.ObjFtry);t.MCFtry=e,__reflect(e.prototype,"h5game.MCFtry")}(h5game||(h5game={}));